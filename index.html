<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Επικοινωνία | Aggelopoulos Carpentry</title>
  <meta name="description" content="Ζητήστε δωρεάν μέτρηση. Φόρμα επικοινωνίας με αποστολή φωτογραφιών, τηλέφωνο και χάρτη.">
  <style>
    :root{--accent:#5D4E37;--bg:#f7f8fb;--muted:#6b6b6b;--ink:#111}
    *{box-sizing:border-box}
    body{margin:0;font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto;color:var(--ink);background:var(--bg)}
    a{color:var(--accent)}
    header{position:sticky;top:0;z-index:10;background:#fff;border-bottom:1px solid rgba(93,78,55,.12);backdrop-filter:saturate(180%) blur(4px)}
    .wrap{max-width:1080px;margin:0 auto;padding:20px 22px}
    .header-inner{display:flex;gap:14px;align-items:center;justify-content:space-between}
    .logo img{height:48px;width:auto;display:block}
    nav{display:flex;gap:14px;flex-wrap:wrap;align-items:center}
    .btn{border:none;border-radius:999px;padding:13px 18px;background:var(--accent);color:#fff;font-weight:800;cursor:pointer;text-decoration:none}
    .btn[disabled]{opacity:.6;cursor:not-allowed}
    .pill{border:1px solid rgba(93,78,55,.25);padding:9px 14px;border-radius:999px;background:#fff;text-decoration:none;color:#111;font-weight:700}
    .hero{padding:28px 22px 12px}
    .hero h1{margin:8px 0 4px;font-size:clamp(28px,5.2vw,52px);line-height:1.1}
    .muted{color:var(--muted)}
    .grid{display:grid;grid-template-columns:1.4fr .9fr;gap:20px}@media(max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:#fff;border:1px solid rgba(93,78,55,.15);border-radius:18px;box-shadow:0 1px 3px rgba(0,0,0,.06);padding:24px}
    form{display:grid;gap:16px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}@media(max-width:720px){.row{grid-template-columns:1fr}}
    label{font-weight:800;display:block;margin:0 0 6px}
    input,textarea,select{width:100%;border:1px solid #d8d8d8;border-radius:14px;padding:12px 14px;font:inherit;outline:none;background:#fff}
    input:focus,textarea:focus,select:focus{border-color:var(--accent);box-shadow:0 0 0 4px rgba(93,78,55,.08)}
    .help{color:var(--muted);font-size:.95rem}
    .err{color:#b00020;font-weight:700;margin-top:6px;display:none}
    .show{display:block}
    .gallery{display:flex;flex-wrap:wrap;gap:10px}
    .thumb{position:relative;width:110px;height:90px;border-radius:10px;overflow:hidden;border:1px solid #e3e3e3;background:#fafafa;display:grid;place-items:center}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .thumb button{position:absolute;top:4px;right:4px;border:none;border-radius:999px;background:rgba(0,0,0,.7);color:#fff;width:24px;height:24px;cursor:pointer}
    .aside .card{position:sticky;top:88px}
    iframe.map{width:100%;height:260px;border:0;border-radius:12px}
    footer{margin-top:30px;padding:20px 0;border-top:1px solid rgba(93,78,55,.12);color:#555}
    /* Spacing & consent block */
    .consent{margin:8px 0 18px;padding:12px 14px;border:1px solid #e8e1d8;border-radius:14px;background:#fafafa}
    .consent .consent-row{display:flex;gap:12px;align-items:flex-start}
    .consent input[type="checkbox"]{width:20px;height:20px;margin-top:3px}
    #sendBtn{margin-top:6px}
  </style>
</head>
<body>
<header>
  <div class="wrap header-inner">
    <a class="logo" href="/"><img src="/assets/logo-dark.png" alt="Aggelopoulos Carpentry — Carpentry Solutions"></a>
    <nav>
      <a class="pill" href="/#services">Υπηρεσίες</a>
      <a class="btn" href="tel:+306936815779">Κάλεσε Τώρα</a>
    </nav>
  </div>
</header>

<section class="wrap hero">
  <h1>Ζητήστε Δωρεάν Μέτρηση</h1>
  <p class="muted">Συμπληρώστε τη φόρμα, ανεβάστε έως 5 φωτογραφίες και θα επικοινωνήσουμε εντός 24 ωρών.</p>
</section>

<main class="wrap">
  <div class="grid">
    <section class="card">
      <div id="alert" aria-live="polite"></div>

      <form id="contact" action="https://api.web3forms.com/submit" method="POST" enctype="multipart/form-data" novalidate>
        <input type="hidden" name="access_key" value="e3990b79-e6a8-4d69-8f86-e605c272f526">
        <input type="hidden" name="from_name" value="Aggelopoulos Carpentry Website">
        <input type="hidden" name="subject" value="Νέο αίτημα (φόρμα επικοινωνίας)">
        <input type="hidden" name="replyto" value="email">
        <input type="text" name="_gotcha" tabindex="-1" autocomplete="off" style="position:absolute;left:-9999px;height:0" aria-hidden="true">
        <input type="hidden" name="_started" id="started">

        <div class="row">
          <div>
            <label for="name">Ονοματεπώνυμο *</label>
            <input id="name" name="name" autocomplete="name" required minlength="3" placeholder="π.χ. Δήμητρα Μ.">
            <div class="err" id="e-name">Συμπληρώστε τουλάχιστον 3 χαρακτήρες.</div>
          </div>
          <div>
            <label for="phone">Τηλέφωνο *</label>
            <input id="phone" name="phone" inputmode="tel" autocomplete="tel" required pattern="^[0-9+ ()-]{8,}$" placeholder="π.χ. 693 000 0000">
            <div class="err" id="e-phone">Δώστε έγκυρο τηλέφωνο.</div>
          </div>
        </div>

        <div>
          <label for="email">Email (προαιρετικό)</label>
          <input id="email" name="email" type="email" autocomplete="email" placeholder="name@example.com">
          <div class="err" id="e-email">Το email δεν είναι έγκυρο.</div>
        </div>

        <div>
          <label for="message">Μήνυμα *</label>
          <textarea id="message" name="message" rows="6" required placeholder="Περιγράψτε χώρο/διαστάσεις, υλικά, χρόνο παράδοσης κ.λπ."></textarea>
          <div class="err" id="e-message">Γράψτε τουλάχιστον 10 χαρακτήρες.</div>
          <p class="help">Μπορείτε να στείλετε φωτογραφίες κάτω από 4MB η καθεμία.</p>
        </div>

        <div>
          <label for="photos">Φωτογραφίες (έως 5)</label>
          <input id="photos" name="attachments" type="file" accept="image/*" multiple>
          <div class="gallery" id="gallery"></div>
          <div class="err" id="e-photos" style="display:none"></div>
        </div>

        <div class="consent">
          <div class="consent-row">
            <input id="privacy" type="checkbox" required>
            <label for="privacy" style="font-weight:600;margin:0">Συμφωνώ να επικοινωνήσετε για την προσφορά.</label>
          </div>
        </div>
        <div class="err" id="e-privacy">Απαιτείται συγκατάθεση.</div>

        <button class="btn" id="sendBtn" type="submit">Αποστολή</button>
        <p class="help" style="margin-top:6px">Ή καλέστε στο <a href="tel:+306936815779">693 6815 779</a>.</p>
      </form>
    </section>

    <aside class="aside">
      <div class="card">
        <h3 style="margin-top:0">Στοιχεία Επικοινωνίας</h3>
        <p><strong>Τηλέφωνο:</strong> <a href="tel:+306936815779">(+30) 693 6815 779</a><br>
        <strong>Email:</strong> <a href="mailto:basilisangelopoulos1965@gmail.com">basilisangelopoulos1965@gmail.com</a><br>
        <strong>Διεύθυνση:</strong> Χρυσάνθου 58, Περιστέρι, 12136</p>
        <iframe class="map" loading="lazy" referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps?q=%CE%A7%CF%81%CF%85%CF%83%CE%AC%CE%BD%CE%B8%CE%BF%CF%85%2058%2C%20%CE%A0%CE%B5%CF%81%CE%B9%CF%83%CF%84%CE%AD%CF%81%CE%B9%2C%2012136&output=embed"
          title="Χάρτης Aggelopoulos Carpentry"></iframe>
        <p class="help" style="margin-top:8px"><a target="_blank" rel="noopener" href="https://www.google.com/maps/search/?api=1&query=%CE%A7%CF%81%CF%85%CF%83%CE%AC%CE%BD%CE%B8%CE%BF%CF%85%2058%2C%20%CE%A0%CE%B5%CF%81%CE%B9%CF%83%CF%84%CE%AD%CF%81%CE%B9%2C%2012136">Άνοιγμα στους Χάρτες Google</a></p>
      </div>
    </aside>
  </div>
</main>

<footer><div class="wrap">© Aggelopoulos Carpentry — Περιστέρι</div></footer>

<script>
(function(){
  const form = document.getElementById('contact');
  const btn  = document.getElementById('sendBtn');
  const alertBox = document.getElementById('alert');
  const started = document.getElementById('started');
  const fileInput = document.getElementById('photos');
  const gallery = document.getElementById('gallery');
  started.value = String(Date.now());

  function showError(id, show, msg){const el=document.getElementById(id);if(!el)return; if(msg) el.textContent=msg; el.style.display=show?'block':'none'}
  const emailOk = v => !v || /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
  const telOk   = v => /^[0-9+ ()-]{8,}$/.test(v||'');
  const minLen  = (v,n) => (v||'').trim().length>=n;

  const MAX_FILES = 5, MAX_EACH = 4*1024*1024;
  function refreshGallery(files){
    gallery.innerHTML='';
    [...files].forEach((file, idx)=>{
      const item = document.createElement('div'); item.className='thumb';
      const img = document.createElement('img'); img.alt = file.name;
      item.appendChild(img);
      const rm = document.createElement('button'); rm.type='button'; rm.innerHTML='×';
      rm.addEventListener('click', ()=>{ const list=[...fileInput.files]; list.splice(idx,1); const dt=new DataTransfer(); list.forEach(f=>dt.items.add(f)); fileInput.files=dt.files; refreshGallery(fileInput.files); });
      item.appendChild(rm);
      gallery.appendChild(item);
      const reader = new FileReader(); reader.onload = e => img.src = e.target.result; reader.readAsDataURL(file);
    });
  }
  fileInput.addEventListener('change', ()=>{
    const files = fileInput.files;
    if(files.length > MAX_FILES){ showError('e-photos', true, 'Μπορείτε έως '+MAX_FILES+' εικόνες.'); const dt=new DataTransfer(); [...files].slice(0,MAX_FILES).forEach(f=>dt.items.add(f)); fileInput.files = dt.files; }
    else showError('e-photos', false);
    for(const f of fileInput.files){ if(f.size > MAX_EACH){ showError('e-photos', true, 'Κάθε εικόνα έως 4MB.'); break; } }
    refreshGallery(fileInput.files);
  });

  form.addEventListener('submit', async (e)=>{
    e.preventDefault(); alertBox.innerHTML='';
    const fd = new FormData(form);
    const v = { name:fd.get('name'), phone:fd.get('phone'), email:fd.get('email'), message:fd.get('message'), privacy:document.getElementById('privacy').checked };
    let ok = true;
    if(!minLen(v.name,3)){showError('e-name', true); ok=false;} else showError('e-name', false);
    if(!telOk(v.phone)){showError('e-phone', true); ok=false;} else showError('e-phone', false);
    if(!emailOk(v.email)){showError('e-email', true); ok=false;} else showError('e-email', false);
    if(!minLen(v.message,10)){showError('e-message', true); ok=false;} else showError('e-message', false);
    if(!v.privacy){showError('e-privacy', true); ok=false;} else showError('e-privacy', false);

    const tookMs = Date.now() - Number(started.value||0);
    if (tookMs < 2500) { ok = false; alertBox.innerHTML = '<div class="fail">Πολύ γρήγορη υποβολή. Παρακαλώ ξαναδοκιμάστε.</div>'; }

    for(const f of (fileInput.files||[])){ if(f.size>MAX_EACH){ ok=false; showError('e-photos', true, 'Κάθε εικόνα έως 4MB.'); break; } }

    if(!ok) return;

    btn.disabled = true; const old = btn.textContent; btn.textContent='Αποστολή…';
    try{ const resp = await fetch(form.action, { method:'POST', body: fd, headers:{'Accept':'application/json'} });
      const data = await resp.json().catch(()=>({}));
      if(resp.ok){ form.reset(); started.value=String(Date.now()); gallery.innerHTML=''; alertBox.innerHTML='<div class="success">Ελήφθη! Θα επικοινωνήσουμε σύντομα.</div>'; }
      else { const msg=(data&&data.message)||'Κάτι πήγε στραβά.'; alertBox.innerHTML='<div class="fail">'+msg+' Δοκιμάστε ξανά ή καλέστε στο <a href="tel:+306936815779">693 6815 779</a>.</div>'; }
    }catch(err){ alertBox.innerHTML='<div class="fail">Αποτυχία δικτύου. Δοκιμάστε ξανά ή καλέστε στο <a href="tel:+306936815779">693 6815 779</a>.</div>'; }
    finally{ btn.disabled=false; btn.textContent=old; }
  });
})();
</script>
</body>
</html>
